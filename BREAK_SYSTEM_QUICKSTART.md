# ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ (Break System Quick Start)

**–í—Ä–µ–º—è –Ω–∞ –ø–æ–ª–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É:** 30-45 –º–∏–Ω—É—Ç
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 09.12.2025

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Ä–∞–±–æ—Ç–µ

### ‚úÖ –≠—Ç–∞–ø 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (5 –º–∏–Ω—É—Ç)

- [ ] Python 3.8+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `python --version`
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: `pip install -r requirements.txt`
- [ ] Supabase –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ:
  - [ ] SUPABASE_URL –≤ .env
  - [ ] SUPABASE_KEY –≤ .env
- [ ] Telegram –±–æ—Ç –≥–æ—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
  - [ ] TELEGRAM_BOT_TOKEN
  - [ ] TELEGRAM_ADMIN_GROUP_ID

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Python
python --version

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
python -c "from supabase_api import get_supabase_api; print('‚úÖ Supabase OK')"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
python -c "from config import USE_SUPABASE; print(f'Using: {\"Supabase\" if USE_SUPABASE else \"Google Sheets\"}')"
```

---

### ‚úÖ –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ (10 –º–∏–Ω—É—Ç)

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–¥–º–∏–Ω-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `python admin_app/main_admin.py`
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Break Manager ‚Üí Create Schedule**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å:
   ```
   Schedule ID: SHIFT_8H_5_2
   Name: –ì—Ä–∞—Ñ–∏–∫ 5/2 (9:00-17:00)
   Shift Start: 09:00
   Shift End: 17:00
   ```
4. –î–æ–±–∞–≤–∏—Ç—å 3 —Å–ª–æ—Ç–∞ "–ü–µ—Ä–µ—Ä—ã–≤":
   ```
   Type: –ü–µ—Ä–µ—Ä—ã–≤ (–∫–∞–∂–¥—ã–π)
   Duration: 15 –º–∏–Ω
   Window: 10:00 - 12:00 (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ)
   Window: 14:00 - 16:00 (–¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ)
   Window: 16:00 - 17:00 (–¥–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ)
   ```
5. –î–æ–±–∞–≤–∏—Ç—å 1 —Å–ª–æ—Ç "–û–±–µ–¥":
   ```
   Type: –û–±–µ–¥
   Duration: 60 –º–∏–Ω
   Window: 12:00 - 14:00
   ```
6. –ù–∞–∂–∞—Ç—å **Create** ‚úÖ

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Python —Å–∫—Ä–∏–ø—Ç**

```python
from supabase_api import get_supabase_api
from admin_app.break_manager import BreakManager

api = get_supabase_api()
mgr = BreakManager(api)

mgr.create_schedule(
    schedule_id="SHIFT_8H_5_2",
    name="–ì—Ä–∞—Ñ–∏–∫ 5/2 (9:00-17:00)",
    shift_start="09:00",
    shift_end="17:00",
    limits=[
        {"break_type": "–ü–µ—Ä–µ—Ä—ã–≤", "daily_count": 3, "time_minutes": 15},
        {"break_type": "–û–±–µ–¥", "daily_count": 1, "time_minutes": 60}
    ],
    windows=[
        {"break_type": "–ü–µ—Ä–µ—Ä—ã–≤", "start": "10:00", "end": "12:00", "priority": 1},
        {"break_type": "–ü–µ—Ä–µ—Ä—ã–≤", "start": "14:00", "end": "16:00", "priority": 1},
        {"break_type": "–û–±–µ–¥", "start": "12:00", "end": "14:00", "priority": 1}
    ]
)
print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ —Å–æ–∑–¥–∞–Ω")
```

---

### ‚úÖ –≠—Ç–∞–ø 3: –ù–∞–∑–Ω–∞—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (5 –º–∏–Ω—É—Ç)

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Users Management**
2. –í—ã–±—Ä–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ù–∞–∂–∞—Ç—å **Assign Break Schedule**
4. –í—ã–±—Ä–∞—Ç—å `SHIFT_8H_5_2`
5. –ù–∞–∂–∞—Ç—å **Assign** ‚úÖ

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Python**

```python
from supabase_api import get_supabase_api
from admin_app.break_manager import BreakManager

api = get_supabase_api()
mgr = BreakManager(api)

# –ù–∞–∑–Ω–∞—á–∏—Ç—å –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
mgr.assign_schedule(
    email="ivan@company.com",
    schedule_id="SHIFT_8H_5_2",
    admin_email="admin@company.com"
)
print("‚úÖ –ì—Ä–∞—Ñ–∏–∫ –Ω–∞–∑–Ω–∞—á–µ–Ω")

# –ù–∞–∑–Ω–∞—á–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö –≤ CSV
import csv
with open('users.csv') as f:
    for row in csv.DictReader(f):
        mgr.assign_schedule(
            email=row['email'],
            schedule_id="SHIFT_8H_5_2",
            admin_email="admin@company.com"
        )
print(f"‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º")
```

---

### ‚úÖ –≠—Ç–∞–ø 4: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, 10 –º–∏–Ω—É—Ç)

**–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞**

1. –û—Ç–∫—Ä—ã—Ç—å @BotFather –≤ Telegram
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å `/newbot`
3. –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω: `123456:ABC-DEF1234ghIkl...`

**–®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É –¥–ª—è –∞–¥–º–∏–Ω–æ–≤**

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø—Ä–∏–≤–∞—Ç–Ω—É—é –≥—Ä—É–ø–ø—É
2. –î–æ–±–∞–≤–∏—Ç—å —Ç—É–¥–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –±–æ—Ç–∞
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ: `@botusername` –∏–ª–∏ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –ü–µ—Ä–µ–π—Ç–∏: `https://api.telegram.org/bot<TOKEN>/getUpdates`
5. –ù–∞–π—Ç–∏ `"chat":{"id":-987654321}` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ)
6. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID –≥—Ä—É–ø–ø—ã

**–®–∞–≥ 3: –ó–∞–ø–∏—Å–∞—Ç—å –≤ .env**

```bash
TELEGRAM_BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
TELEGRAM_ADMIN_GROUP_ID=-987654321
```

**–®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ config.py**

```python
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å True
BREAK_NOTIFY_USER_ON_VIOLATION = True
BREAK_NOTIFY_ADMIN_ON_VIOLATION = True
```

---

### ‚úÖ –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (5-10 –º–∏–Ω—É—Ç)

**–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é**

```bash
python dev-tools/diagnostic/check_break_init.py
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ‚úÖ Break system initialized
```

**–¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫**

```python
from supabase_api import get_supabase_api
from admin_app.break_manager import BreakManager

api = get_supabase_api()
mgr = BreakManager(api)

schedule = mgr.get_user_schedule("ivan@company.com")
print(f"‚úÖ –ì—Ä–∞—Ñ–∏–∫: {schedule.name if schedule else '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}")
if schedule:
    print(f"   –õ–∏–º–∏—Ç—ã: {[(l.break_type, l.daily_count, l.time_minutes) for l in schedule.limits]}")
```

**–¢–µ—Å—Ç 3: –†—É—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ/–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–µ—Ä–µ—Ä—ã–≤–∞**

```python
from shared.break_status_integration import on_status_change, on_logout

# –ù–∞—á–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤
print("1Ô∏è‚É£  –ù–∞—á–∏–Ω–∞–µ–º –ø–µ—Ä–µ—Ä—ã–≤...")
on_status_change(
    email="ivan@company.com",
    old_status="–†–∞–±–æ—Ç–∞—é",
    new_status="–ü–µ—Ä–µ—Ä—ã–≤",
    session_id="test-123"
)
print("‚úÖ –ü–µ—Ä–µ—Ä—ã–≤ –Ω–∞—á–∞—Ç")

# –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–µ—Ä–µ—Ä—ã–≤ (—á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥)
import time
time.sleep(30)
print("\n2Ô∏è‚É£  –ó–∞–≤–µ—Ä—à–∞–µ–º –ø–µ—Ä–µ—Ä—ã–≤...")
on_status_change(
    email="ivan@company.com",
    old_status="–ü–µ—Ä–µ—Ä—ã–≤",
    new_status="–†–∞–±–æ—Ç–∞—é"
)
print("‚úÖ –ü–µ—Ä–µ—Ä—ã–≤ –∑–∞–≤–µ—Ä—à–µ–Ω")

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
status = mgr.get_break_status("ivan@company.com")
print(f"\n3Ô∏è‚É£  –°—Ç–∞—Ç—É—Å: {status}")
```

**–¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–∑–æ–≤—ã Telegram (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)**

1. –í—ã–ø–æ–ª–Ω–∏—Ç—å –¢–µ—Å—Ç 3
2. –ï—Å–ª–∏ –ø–µ—Ä–µ—Ä—ã–≤ –±—ã–ª –¥–æ–ª—å—à–µ 15 –º–∏–Ω—É—Ç - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É
3. ‚úÖ –ï—Å–ª–∏ –ø—Ä–∏—à–ª–æ - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üéØ –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–µ—Ä–µ—Ä—ã–≤

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å ‚Üí "–ü–µ—Ä–µ—Ä—ã–≤"
2. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
   ‚úì –ï—Å—Ç—å –ª–∏ –≥—Ä–∞—Ñ–∏–∫?
   ‚úì –ù–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∞ –ª–∏ –∫–≤–æ—Ç–∞ (3/3)?
   ‚úì –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –≤—Ä–µ–º—è (10:00-12:00)?
3. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ BreakLog:
   Email, Name, BreakType, StartTime, Status=Active
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Telegram (–µ—Å–ª–∏ –≤–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –æ–∫–Ω–∞):
   ‚ö†Ô∏è –ü–µ—Ä–µ—Ä—ã–≤ –Ω–∞—á–∞—Ç –≤–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
5. BreakInfoWidget –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: "üü¢ –ê–∫—Ç–∏–≤–µ–Ω: –ü–µ—Ä–µ—Ä—ã–≤ (0/15 –º–∏–Ω)"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø–µ—Ä–µ—Ä—ã–≤

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å ‚Üí "–†–∞–±–æ—Ç–∞—é" (–∏–ª–∏ –¥—Ä—É–≥–æ–π)
2. –°–∏—Å—Ç–µ–º–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. –û–±–Ω–æ–≤–ª—è–µ—Ç BreakLog:
   EndTime, Duration (–Ω–∞–ø—Ä–∏–º–µ—Ä, 20 –º–∏–Ω), Status=Completed
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏–º–∏—Ç:
   - –ï—Å–ª–∏ 20 > 15 + 2 –º–∏–Ω ‚Üí OVER_LIMIT (–Ω–∞—Ä—É—à–µ–Ω–∏–µ)
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Telegram –∞–¥–º–∏–Ω—É + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
5. BreakInfoWidget –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: "üìä –û—Å—Ç–∞–ª–æ—Å—å: 2/3"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–æ–π –∫–≤–æ—Ç—ã

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç 4-–π –ø–µ—Ä–µ—Ä—ã–≤ (–∫–æ–≥–¥–∞ –ª–∏–º–∏—Ç 3)
2. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç QUOTA_EXCEEDED (–Ω–∞—Ä—É—à–µ–Ω–∏–µ)
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Telegram
4. ‚úÖ –í–°–ï –†–ê–í–ù–û –†–ê–ó–†–ï–®–ê–ï–¢ –ü–ï–†–ï–†–´–í (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç)
5. –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–µ –≤ Dashboard
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: Logout –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ä—ã–≤–∞

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤ (–±–µ–∑ EndTime)
3. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç end_break()
4. –ó–∞–≤–µ—Ä—à–∞–µ—Ç –ø–µ—Ä–µ—Ä—ã–≤ —Å —Ç–µ–∫—É—â–µ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
5. ‚úÖ –ü–µ—Ä–µ—Ä—ã–≤ –∑–∞–ø–∏—Å–∞–Ω –≤ BreakLog —Å Duration
```

---

## üîç –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ä—ã–≤–æ–≤

```python
from supabase_api import get_supabase_api
from admin_app.break_manager import BreakManager

api = get_supabase_api()
mgr = BreakManager(api)

active = mgr.get_all_active_breaks()
for b in active:
    print(f"{b['Email']}: {b['BreakType']} ({b['Duration']} –º–∏–Ω)")
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```python
status = mgr.get_break_status("ivan@company.com")
print(f"–ì—Ä–∞—Ñ–∏–∫: {status['schedule']['name']}")
print(f"–ü–µ—Ä–µ—Ä—ã–≤—ã: {status['used_today']['–ü–µ—Ä–µ—Ä—ã–≤']}/3")
print(f"–û–±–µ–¥: {status['used_today']['–û–±–µ–¥']}/1")
if status['active_break']:
    print(f"üü¢ –ê–∫—Ç–∏–≤–µ–Ω: {status['active_break']['duration']} –º–∏–Ω")
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞—Ä—É—à–µ–Ω–∏–π –∑–∞ –¥–µ–Ω—å

```python
from datetime import date

violations = mgr.get_violations_report(
    date_from=str(date.today()),
    date_to=str(date.today())
)

for v in violations:
    print(f"‚ö†Ô∏è  {v['Email']}: {v['ViolationType']}")
    print(f"   {v['Details']}")
```

---

## ‚ùå –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| **"No schedule found"** | –ù–µ—Ç –≥—Ä–∞—Ñ–∏–∫–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ù–∞–∑–Ω–∞—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å |
| **–ü–µ—Ä–µ—Ä—ã–≤ –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è** | BreakStatusIntegration –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å main.py –≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é |
| **Telegram –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç** | –¢–æ–∫–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å TELEGRAM_BOT_TOKEN –≤ .env |
| **–õ–∏–º–∏—Ç—ã —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** | –†–∞–∑–Ω–∏—Ü–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ / —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É –≤ –ë–î |
| **EndTime –ø—É—Å—Ç–æ–π** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª –ø–µ—Ä–µ—Ä—ã–≤ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å on_logout –≤ –≥–ª–∞–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ |

---

## üìû –®–∞–±–ª–æ–Ω—ã Telegram-—Å–æ–æ–±—â–µ–Ω–∏–π

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏

```
‚ö†Ô∏è –ü–†–ï–í–´–®–ï–ù –õ–ò–ú–ò–¢ –ü–ï–†–ï–†–´–í–ê

–í–∞—à –ø–µ—Ä–µ—Ä—ã–≤: 20 –º–∏–Ω—É—Ç
–õ–∏–º–∏—Ç: 15 –º–∏–Ω—É—Ç
–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ: +5 –º–∏–Ω—É—Ç

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤.
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

```
üö´ –ü–†–ï–í–´–®–ï–ù –õ–ò–ú–ò–¢ –ü–ï–†–ï–†–´–í–û–í

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: 4
–î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç: 3

–ë–æ–ª—å—à–µ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É –æ –Ω–∞—Ä—É—à–µ–Ω–∏–∏

```
‚ö†Ô∏è –ù–ê–†–£–®–ï–ù–ò–ï –õ–ò–ú–ò–¢–ê

–°–æ—Ç—Ä—É–¥–Ω–∏–∫: ivan@company.com (–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤)
–¢–∏–ø: –ü–µ—Ä–µ—Ä—ã–≤
–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 25 –º–∏–Ω (–ª–∏–º–∏—Ç 15 –º–∏–Ω)
–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ: +10 –º–∏–Ω
–í—Ä–µ–º—è: 14:35:22
```

---

## üìä SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–µ—Ä–µ—Ä—ã–≤—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

```sql
SELECT email, name, break_type, start_time,
       EXTRACT(EPOCH FROM (NOW() - start_time)) / 60 as duration_minutes
FROM break_log
WHERE end_time IS NULL
AND date = CURRENT_DATE
ORDER BY start_time DESC;
```

### –¢–æ–ø –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π –∑–∞ –Ω–µ–¥–µ–ª—é

```sql
SELECT email, COUNT(*) as violations
FROM violations
WHERE date >= CURRENT_DATE - INTERVAL '7 days'
GROUP BY email
ORDER BY violations DESC
LIMIT 10;
```

### –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ä—ã–≤–æ–≤

```sql
SELECT break_type,
       ROUND(AVG(duration_minutes)::numeric, 2) as avg_minutes,
       COUNT(*) as total_breaks
FROM break_log
WHERE date >= CURRENT_DATE - INTERVAL '30 days'
AND status = 'Completed'
GROUP BY break_type;
```

### –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ø–µ—Ä–µ—Ä—ã–≤–∞—Ö —Å–µ–π—á–∞—Å

```sql
SELECT
    ROUND(100.0 * COUNT(DISTINCT email) /
    (SELECT COUNT(*) FROM users WHERE is_active = true), 2) as percentage_in_break
FROM break_log
WHERE end_time IS NULL
AND date = CURRENT_DATE;
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ó–∞–≤–µ—Ä—à–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É** - –≤—ã–ø–æ–ª–Ω–∏—Ç—å —á–µ–∫-–ª–∏—Å—Ç –≤—ã—à–µ
2. ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã** - —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –¥–æ–±–∞–≤–∏—Ç—å –¥–∞—à–±–æ—Ä–¥ –∞–¥–º–∏–Ω–∞
4. ‚úÖ **–û–±—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - –æ–±—ä—è—Å–Ω–∏—Ç—å –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è
5. ‚úÖ **–°–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏** - –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏—è –∏ —É–ª—É—á—à–∞—Ç—å

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- üìñ **–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** `BREAK_SYSTEM_ANALYSIS.md`
- üîß **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** `dev-tools/diagnostic/diagnose_breaks.py`
- üìã **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `config.py` (—Å—Ç—Ä–æ–∫–∏ 200-501)
- üíæ **–ë–î:** `supabase_schema.sql`
- ü§ñ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** `shared/break_status_integration.py`

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–í—Ä–µ–º—è –Ω–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ:** 15 –º–∏–Ω—É—Ç
**–í—Ä–µ–º—è –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é:** 30-45 –º–∏–Ω—É—Ç
